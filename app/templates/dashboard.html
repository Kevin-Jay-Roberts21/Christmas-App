{% extends "base.html" %}
{% block content %}
{% set mem_map = mem_map|default({}) %}
{% set list_for_group = list_for_group|default({}) %}

<h2>Account</h2>

<!-- Lists section -->
<section class="card">
  <div class="card-header">
    <h3>Your Lists</h3>
    <a class="btn" href="/lists/new">Create List</a>
  </div>

  {% if lists|length == 0 %}
    <p>You don’t have any lists yet. Click “Create List” to get started.</p>
  {% else %}
    <ul>
      {% for lst in lists %}
        <li>
          <strong>{{ lst.name }}</strong>
          <a class="btn btn-small" href="/lists/{{ lst.id }}">View</a>
          <a class="btn btn-small" href="/lists/{{ lst.id }}/edit">Edit</a>
        </li>
      {% endfor %}
    </ul>
  {% endif %}
</section>

<!-- Groups section -->
<section class="card">
  <div class="card-header">
    <h3>Your Groups</h3>
  </div>

  {% if groups|length == 0 %}
    <p>You’re not in any groups yet.</p>
  {% else %}
    <ul>
      {% for g in groups %}
        {% set mem = mem_map.get(g.id) %}
        <li>
          <strong>{{ g.name }}</strong>
          {% if mem and not mem.is_approved and not mem.is_denied %}
            <span class="tag">Pending</span>
          {% elif mem and mem.is_denied %}
            <span class="tag" style="background:#fee2e2;color:#991b1b;">Denied</span>
          {% else %}
            <a href="/groups/{{ g.id }}" class="btn">View Group</a>
          {% endif %}

          {% if mem and mem.selected_list_id %}
            <small> Your applied list:
              <a href="/lists/{{ mem.selected_list_id }}">View List</a>
            </small>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% endif %}
</section>

{% endblock %}
